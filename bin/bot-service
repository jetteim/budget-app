#!/usr/bin/env ruby
class BotService
  require 'colorize'
  require './lib/telegram_listener.rb'
  require './lib/telegram_responder.rb'
  require './lib/input_processor.rb'

  TELEGRAM_TOKEN = '465826703:AAGyl640kAtVlUN4NMmm0eHkn_QifmLKJWc'.freeze
  
  listener = TelegramListener.new(TELEGRAM_TOKEN)
  responder = TelegramResponder.new(TELEGRAM_TOKEN)
  processor = InputProcessor.new
  loop do
	replies = []
	listener.getUpdatesBunlde.each {|user, input| replies << processor.process_telegram(user, input)}
 	responder.replyBundle(replies.flatten)
  end
end
